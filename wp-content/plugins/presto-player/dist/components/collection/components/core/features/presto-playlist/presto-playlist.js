import{h}from"@stencil/core";export class PrestoPlaylist{constructor(){this.items=void 0,this.heading=void 0,this.listTextSingular=void 0,this.listTextPlural=void 0,this.transitionDuration=5,this.currentPlaylistItem=void 0,this.currentPlyr=void 0,this.playing=!1}rewatch(){this.handlePlay()}next(){this.handleNext()}handleCurrentPlay(t,e){var i;t&&(this.addOverlay(),this.currentPlyr.elements.container.getRootNode().host.style=this.currentPlaylistItem.config.styles,void 0!==e&&("youtube"===this.currentPlyr.provider&&!this.currentPlyr.muted&&(null===(i=this.currentPlyr)||void 0===i?void 0:i.embed)&&this.currentPlyr.embed.unMute(),this.currentPlyr.play()))}addOverlay(){var t,e;this.overlay=document.createElement("presto-playlist-overlay"),this.overlay.nextItemTitle=this.getNextItemTitle(),this.overlay.isLastItem=this.isLastItem(),this.overlay.nextItemString=(null==this?void 0:this.listTextSingular)||"Video",this.overlay.transitionDuration=this.transitionDuration,null===(e=null===(t=this.currentPlyr.elements)||void 0===t?void 0:t.container)||void 0===e||e.closest(".presto-player__wrapper").append(this.overlay)}componentWillLoad(){var t;this.currentPlaylistItem=(null===(t=null==this?void 0:this.items)||void 0===t?void 0:t[0])||null}handleItemClick(t){this.overlay&&(this.overlay.show=!1),this.el.style.height=this.el.offsetHeight+"px",this.el.style.width=this.el.offsetWidth+"px",this.currentPlaylistItem=t}handleNext(){this.overlay.show=!1,this.currentPlaylistItem=this.getNextItem()||this.currentPlaylistItem}handlePlay(){this.overlay&&(this.overlay.show=!1),this.currentPlyr.play()}handlePause(){this.overlay.show=!1,this.currentPlyr.pause()}getNextItem(){var t,e,i,l;if(this.isLastItem())return this.items[0];let r;for(let s=0;s<(null===(t=this.items)||void 0===t?void 0:t.length);s++)if((null===(e=this.items[s])||void 0===e?void 0:e.id)===(null===(i=this.currentPlaylistItem)||void 0===i?void 0:i.id)&&(null===(l=this.items)||void 0===l?void 0:l.length)!==s+1){r=this.items[s+1];break}return r}isLastItem(){var t,e,i;const l=(null===(t=this.items)||void 0===t?void 0:t.length)-1;return(null===(e=this.items[l])||void 0===e?void 0:e.id)===(null===(i=this.currentPlaylistItem)||void 0===i?void 0:i.id)}getNextItemTitle(){var t;const e=this.getNextItem();return void 0!==e?(null==e?void 0:e.title)||(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.title):""}render(){var t,e,i,l,r,s,n,o,a;if(!(null===(t=this.items)||void 0===t?void 0:t.length))return"";const d=this.listTextSingular?this.listTextSingular:"Video",u=this.listTextPlural?this.listTextPlural:"Videos";return h("presto-playlist-ui",null,(null===(e=this.currentPlaylistItem.config)||void 0===e?void 0:e.src)?h("presto-player",Object.assign({slot:"preview",src:null===(i=this.currentPlaylistItem.config)||void 0===i?void 0:i.src},this.currentPlaylistItem.config,{video_id:null===(l=this.currentPlaylistItem.config)||void 0===l?void 0:l.id,id:`presto-player-${null===(r=this.currentPlaylistItem.config)||void 0===r?void 0:r.id}`,"media-title":null===(s=this.currentPlaylistItem.config)||void 0===s?void 0:s.title,class:null===(n=this.currentPlaylistItem.config)||void 0===n?void 0:n.playerClass,key:null===(o=this.currentPlaylistItem.config)||void 0===o?void 0:o.id,provider:null===(a=this.currentPlaylistItem.config)||void 0===a?void 0:a.provider,onPlayerReady:t=>{this.currentPlyr=t.detail,this.el.style.height=null,this.el.style.width=null},onPlayedMedia:()=>this.playing=!0,onPausedMedia:()=>this.playing=!1,onEndedMedia:()=>this.overlay.show=!0})):h("slot",{name:"unauthorized",slot:"preview"}),h("div",{slot:"title"},this.heading||"Playlist"),h("div",{slot:"count"},this.items.length," ",this.items.length>1?u:d),this.items.map((t=>{var e,i,l,r;return h("presto-playlist-item",{slot:"list",onClick:()=>this.handleItemClick(t),active:(null===(e=this.currentPlaylistItem)||void 0===e?void 0:e.id)===(null==t?void 0:t.id),playing:(null===(i=this.currentPlaylistItem)||void 0===i?void 0:i.id)===(null==t?void 0:t.id)&&this.playing,class:(null===(l=this.currentPlaylistItem)||void 0===l?void 0:l.id)===(null==t?void 0:t.id)?"active":"",key:null==t?void 0:t.id,onTriggerPause:()=>this.handlePause(),onTriggerPlay:()=>this.handlePlay()},h("span",{slot:"item-title"},h("span",null,(null==t?void 0:t.title)||(null===(r=null==t?void 0:t.config)||void 0===r?void 0:r.title))),h("span",{slot:"item-duration"},h("span",null,null==t?void 0:t.duration)))})))}static get is(){return"presto-playlist"}static get encapsulation(){return"shadow"}static get originalStyleUrls(){return{$:["presto-playlist.scss"]}}static get styleUrls(){return{$:["presto-playlist.css"]}}static get properties(){return{items:{type:"unknown",mutable:!1,complexType:{original:"Array<PlaylistItem>",resolved:"PlaylistItem[]",references:{Array:{location:"global"},PlaylistItem:{location:"import",path:"../../../../interfaces"}}},required:!1,optional:!1,docs:{tags:[],text:"Array of videos from the Playlist"}},heading:{type:"string",mutable:!1,complexType:{original:"string",resolved:"string",references:{}},required:!1,optional:!1,docs:{tags:[],text:"Title for the Playlist"},attribute:"heading",reflect:!1},listTextSingular:{type:"string",mutable:!1,complexType:{original:"string",resolved:"string",references:{}},required:!1,optional:!1,docs:{tags:[],text:"Count prefix string for the Playlist - Singular"},attribute:"list-text-singular",reflect:!1},listTextPlural:{type:"string",mutable:!1,complexType:{original:"string",resolved:"string",references:{}},required:!1,optional:!1,docs:{tags:[],text:"Count prefix string for the Playlist - Plural"},attribute:"list-text-plural",reflect:!1},transitionDuration:{type:"number",mutable:!1,complexType:{original:"number",resolved:"number",references:{}},required:!1,optional:!1,docs:{tags:[],text:"Transition duration for next video."},attribute:"transition-duration",reflect:!1,defaultValue:"5"}}}static get states(){return{currentPlaylistItem:{},currentPlyr:{},playing:{}}}static get elementRef(){return"el"}static get watchers(){return[{propName:"currentPlyr",methodName:"handleCurrentPlay"}]}static get listeners(){return[{name:"rewatch",method:"rewatch",target:void 0,capture:!1,passive:!1},{name:"next",method:"next",target:void 0,capture:!1,passive:!1}]}}